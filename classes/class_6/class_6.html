
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class 6: Advanced pandas &#8212; Python for Neuroscience</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_tabs/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorials" href="../../tutorials.html" />
    <link rel="prev" title="Class 5: The Scientific Stack - Part II: matplotlib and pandas" href="../class_5/class_5.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python for Neuroscience</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../../contents.html">
   Contents
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../class_0/class_0.html">
     Class 0: Background and Basic Syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../class_1/class_1.html">
     Class 1: More Syntax and The Python Stack
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../class_2/class_2.html">
     Class 2: Virtual Environments and Object-oriented Programming (OOP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../class_3/class_3.html">
     Class 3: More OOP and Exception Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../class_4/class_4.html">
     Class 4: The Scientific Stack - Part I:
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../class_5/class_5.html">
     Class 5: The Scientific Stack - Part II:
     <code class="docutils literal notranslate">
      <span class="pre">
       matplotlib
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Class 6: Advanced
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../tutorials.html">
   Tutorials
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/python_setup.html">
     General Setup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/create_git_repo.html">
     Create a Git Repository
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources.html">
   Resources
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/classes/class_6/class_6.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/ZviBaratz/python_for_neuroscientists/issues/new?title=Issue%20on%20page%20%2Fclasses/class_6/class_6.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ZviBaratz/python_for_neuroscientists/main?urlpath=tree/source/classes/class_6/class_6.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-data">
   Missing Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-none-object">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       None
      </span>
     </code>
     object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-nan-value">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       NaN
      </span>
     </code>
     value
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-nat-value">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       NaT
      </span>
     </code>
     value
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operations-and-calculations-with-missing-data">
     Operations and calculations with missing data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filling-missing-values">
       Filling missing values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dropping-missing-values">
       Dropping missing values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interpolation">
       Interpolation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-values-in-non-float-columns">
     Missing Values in Non-Float Columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#categorical-data">
   Categorical Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hierarchical-indexing">
   Hierarchical Indexing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-example-temperature-in-a-grid">
     Simple Example - Temperature in a Grid
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-on-extra-dimensions">
     More on extra dimensions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constructing-a-multiindex">
     Constructing a MultiIndex
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-a-multiindex-from-a-data-column">
       Creating a MultiIndex from a data column
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indexing-and-slicing-a-multiindex">
     Indexing and Slicing a MultiIndex
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#small-caveat-unsorted-indices">
       Small caveat - unsorted indices
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-aggregation">
     Data Aggregation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#n-dimensional-containers">
   <em>
    n
   </em>
   -Dimensional Containers
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="class-6-advanced-pandas">
<h1>Class 6: Advanced <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#class-6-advanced-pandas" title="Permalink to this headline">¶</a></h1>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>’ <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> might seem to us as no more than tables with complicated indexing methods. In this lesson, we will learn more about what makes <code class="docutils literal notranslate"><span class="pre">pandas</span></code> so powerful and how we can use it to write efficient and readable code.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of the features described below only work with pandas &gt;= 1.0.0. Make sure you have the latest pandas installation when running this notebook. To check the version of your pandas (or any other package), import it and print its <code class="docutils literal notranslate"><span class="pre">__version__</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="go">&#39;1.2.0&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="missing-data">
<h2>Missing Data<a class="headerlink" href="#missing-data" title="Permalink to this headline">¶</a></h2>
<div style="text-align:center"><img src="https://static.wikia.nocookie.net/lostpedia/images/1/16/Lost-season1.jpg/revision/latest/scale-to-width-down/300?cb=20070303221754" /></div><p>The last question in the previous class pointed us to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html">working with missing data</a>. But how and why does missing data occur?</p>
<p>One option is pandas’ index alignment, the property that makes sure that each value will have the same index throughout the entire computation process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    NaN
1    5.0
2    9.0
3    NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The NaNs we have are what we call missing data - this is the way pandas represents it. We’ll discuss about it in detail in a few moments.</p>
<p>The same thing occurs with DataFrames:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                 <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                 <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;BAC&#39;</span><span class="p">))</span>
<span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DTypes:</span><span class="se">\n</span><span class="si">{</span><span class="n">new</span><span class="o">.</span><span class="n">dtypes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      A     B   C
0   9.0  12.0 NaN
1  16.0  18.0 NaN
2   NaN   NaN NaN
DTypes:
A    float64
B    float64
C    float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>The DF’s shape is the shape of the larger DF, and the “extra” row (index 2) was filled with NaNs. Since we have NaNs, the data type of the column is implicitly converted to a floating point type. To have integer DataFrames with NAs, we have to explicitly say we want them available. More on that later.</p>
<p>Another way to introduce missing data is through reindexing. If we “resample” our data we can achieve the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.369350</td>
      <td>0.782736</td>
      <td>1.875940</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.600203</td>
      <td>1.002386</td>
      <td>0.182499</td>
    </tr>
    <tr>
      <th>e</th>
      <td>1.759883</td>
      <td>0.930489</td>
      <td>1.564934</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.691812</td>
      <td>-0.203926</td>
      <td>-1.671613</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.889038</td>
      <td>0.416180</td>
      <td>0.506949</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.369350</td>
      <td>0.782736</td>
      <td>1.875940</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.600203</td>
      <td>1.002386</td>
      <td>0.182499</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>e</th>
      <td>1.759883</td>
      <td>0.930489</td>
      <td>1.564934</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.691812</td>
      <td>-0.203926</td>
      <td>-1.671613</td>
    </tr>
    <tr>
      <th>g</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.889038</td>
      <td>0.416180</td>
      <td>0.506949</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we mentioned, pandas is oriented towards handling missing data. In general one finds two approaches that one can take - either create a masking array around the DF, in which <code class="docutils literal notranslate"><span class="pre">False</span></code> values represent invalid entries, or create a <em>sentinel</em> value that represents missing data, like -99999 or NaN.</p>
<p>These two approaches have their downsides - a boolean masks requires more memory, and perhaps longer computation times. The sentinel value might lead to use of inefficient data types and slow down computation as well.</p>
<p>Due to its reliance on numpy, pandas chose the path of sentinel values, with either <code class="docutils literal notranslate"><span class="pre">None</span></code> or NaN as the value.</p>
<div class="section" id="the-none-object">
<h3>The <code class="docutils literal notranslate"><span class="pre">None</span></code> object<a class="headerlink" href="#the-none-object" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code> is standard Python’s null value. It can be found in many places in the language. For example, functions that don’t have a <code class="docutils literal notranslate"><span class="pre">return</span></code> statement, implicitly return <code class="docutils literal notranslate"><span class="pre">None</span></code>. While <code class="docutils literal notranslate"><span class="pre">None</span></code> can be used as a missing data type, it’s probably not the best choice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">vals1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, None, 3, 4], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is <code class="docutils literal notranslate"><span class="pre">object</span></code>, because the best common type of <code class="docutils literal notranslate"><span class="pre">int</span></code>s and a <code class="docutils literal notranslate"><span class="pre">None</span></code> is a Python <code class="docutils literal notranslate"><span class="pre">object</span></code>. This slows down computation time on these arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dtype =&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> np.arange(1E6, dtype=dtype).sum()
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype = object
36.9 ms ± 683 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)

dtype = int
771 µs ± 1.37 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
</div>
</div>
<p>If you recall from a couple of lessons ago, the “object” timings are very similar to those of standard lists, since indeed object arrays are pretty much identical to lists.</p>
<p>Another thing we can’t do is aggregation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">37</span><span class="o">-</span><span class="mi">30</span><span class="n">a3fc8c6726</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">vals1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/numpy/core/_methods.py</span> in <span class="ni">_sum</span><span class="nt">(a, axis, dtype, out, keepdims, initial, where)</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="k">def</span> <span class="nf">_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span>          <span class="n">initial</span><span class="o">=</span><span class="n">_NoValue</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">47</span>     <span class="k">return</span> <span class="n">umr_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> 
<span class="g g-Whitespace">     </span><span class="mi">49</span> <span class="k">def</span> <span class="nf">_prod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for +: &#39;int&#39; and &#39;NoneType&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-nan-value">
<h3>The <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value<a class="headerlink" href="#the-nan-value" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">NaN</span></code> is a special floating-point value recognized by all programming languages that conform to the IEEE standard (which means most of them). As we mentioned before, it forces the entire array to have a floating point type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">vals2</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<p>Creating floating point arrays is very fast, so performance isn’t hindered. NaN is sometimes described as a “data virus”, since it infects objects it touches:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals2</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">vals2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vals2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># runtime warnings (not shown here), not exceptions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(nan, nan, nan)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Numpy has nan-aware counterparts to many of its aggregation functions, which can work with NaNs correctly. They usually have the same name as their non-NaN sibling, but with the “nan” preface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">vals2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">vals2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.0
2.6666666666666665
</pre></div>
</div>
</div>
</div>
<p>However, pandas objects account for NaNs in their calculations, as we’ll soon see.</p>
<p>pandas can handle both <code class="docutils literal notranslate"><span class="pre">NaN</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code> interchangeably:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="n">ser</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.0
1    NaN
2    2.0
3    NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-nat-value">
<h3>The <code class="docutils literal notranslate"><span class="pre">NaT</span></code> value<a class="headerlink" href="#the-nat-value" title="Permalink to this headline">¶</a></h3>
<p>When dealing with datetime values or indices, the missing value is represented as <code class="docutils literal notranslate"><span class="pre">NaT</span></code>, or not-a-time:</p>
<div style="text-align:center"><img src="https://149366099.v2.pressablecdn.com/wp-content/uploads/2014/10/What-is-time.png" /></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20180101&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.369350</td>
      <td>0.782736</td>
      <td>1.875940</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.600203</td>
      <td>1.002386</td>
      <td>0.182499</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>e</th>
      <td>1.759883</td>
      <td>0.930489</td>
      <td>1.564934</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.691812</td>
      <td>-0.203926</td>
      <td>-1.671613</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.889038</td>
      <td>0.416180</td>
      <td>0.506949</td>
      <td>2018-01-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.369350</td>
      <td>0.782736</td>
      <td>1.875940</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.600203</td>
      <td>1.002386</td>
      <td>0.182499</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>e</th>
      <td>1.759883</td>
      <td>0.930489</td>
      <td>1.564934</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.691812</td>
      <td>-0.203926</td>
      <td>-1.671613</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>g</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.889038</td>
      <td>0.416180</td>
      <td>0.506949</td>
      <td>2018-01-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="operations-and-calculations-with-missing-data">
<h3>Operations and calculations with missing data<a class="headerlink" href="#operations-and-calculations-with-missing-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.065449</td>
      <td>0.018906</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.434429</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.229545</td>
      <td>0.586038</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.871537</td>
      <td>0.783734</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.770619</td>
      <td>0.293776</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.640799</td>
      <td>0.920508</td>
      <td>0.211992</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.760239</td>
      <td>0.297325</td>
      <td>0.264362</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.058171</td>
      <td>0.979130</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.294290</td>
      <td>0.664070</td>
      <td>0.890194</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.713352</td>
      <td>0.555523</td>
      <td>0.442812</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.373683</td>
      <td>0.286472</td>
      <td>0.541944</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.483972</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we see, missing values propagate naturally through these arithmetic operations. Statistics also works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="c1"># Summation - NaNs are zero.</span>
<span class="c1"># If everything is NaN - the result is NaN as well.</span>
<span class="c1"># pandas&#39; cumsum and cumprod ignore NaNs but preserve them in the resulting arrays.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.000000</td>
      <td>0.0</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.967686</td>
      <td>NaN</td>
      <td>1.200421</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.471180</td>
      <td>NaN</td>
      <td>0.358539</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.916885</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.193609</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>1.477145</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.483972</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also receive a boolean mask of the NaNs in a dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="c1"># also isna(), and the opposite .notnull()</span>
<span class="n">mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="filling-missing-values">
<h4>Filling missing values<a class="headerlink" href="#filling-missing-values" title="Permalink to this headline">¶</a></h4>
<p>The simplest option is to use the <code class="docutils literal notranslate"><span class="pre">fillna</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">summed</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">summed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>0.0</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>0.0</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>0.0</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;missing&#39;</span><span class="p">)</span>  <span class="c1"># changed dtype to &quot;object&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>missing</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>missing</td>
      <td>missing</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>missing</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>missing</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>missing</td>
      <td>missing</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>missing</td>
      <td>missing</td>
      <td>missing</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">)</span>  <span class="c1"># The NaN column remained the same, but values were propagated forward</span>
<span class="c1"># We can also use the &quot;backfill&quot; method to fill in values to the back</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># No more than one padded NaN in a row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">summed</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># each column received its respective mean. The NaN column is untouched.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>1.200421</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.838615</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.838615</td>
      <td>NaN</td>
      <td>1.200421</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="dropping-missing-values">
<h4>Dropping missing values<a class="headerlink" href="#dropping-missing-values" title="Permalink to this headline">¶</a></h4>
<p>We’ve already seen in the short exercise the <code class="docutils literal notranslate"><span class="pre">dropna</span></code> method, that allows us to drop missing values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filled</span> <span class="o">=</span> <span class="n">summed</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">summed</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">filled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>1.200421</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.838615</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.838615</td>
      <td>NaN</td>
      <td>1.200421</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filled</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># each column containing NaN is dropped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>1.200421</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.838615</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.838615</td>
      <td>1.200421</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filled</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># each row containing a NaN is dropped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="interpolation">
<h4><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html">Interpolation</a><a class="headerlink" href="#interpolation" title="Permalink to this headline">¶</a></h4>
<p>The last way to to fill in missing values is through interpolation.</p>
<p>The default interpolation methods perform linear interpolation on the data, based on its ordinal index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summed</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>  <span class="c1"># notice all the details in the interpolation of the three columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.706248</td>
      <td>NaN</td>
      <td>0.939414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.194669</td>
      <td>NaN</td>
      <td>1.252291</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.287716</td>
      <td>NaN</td>
      <td>1.565168</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>1.447803</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.165827</td>
      <td>NaN</td>
      <td>0.849299</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also interpolate with the actual index values in mind:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create &quot;missing&quot; index</span>
<span class="n">timeindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;1/1/2018&#39;</span><span class="p">,</span> <span class="s1">&#39;1/4/2018&#39;</span><span class="p">,</span> <span class="s1">&#39;1/5/2018&#39;</span><span class="p">,</span> <span class="s1">&#39;1/7/2018&#39;</span><span class="p">,</span> <span class="s1">&#39;1/8/2018&#39;</span><span class="p">])</span>
<span class="n">timeindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">timeindex</span><span class="p">)</span>
<span class="n">data_to_interp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">df_to_interp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_to_interp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">timeindex</span><span class="p">)</span>
<span class="n">df_to_interp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2018-01-04</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018-01-05</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2018-01-07</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018-01-08</th>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_to_interp</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>  <span class="c1"># the index values aren&#39;t taken into account</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2018-01-04</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2018-01-05</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2018-01-07</th>
      <td>6.5</td>
    </tr>
    <tr>
      <th>2018-01-08</th>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_to_interp</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>  <span class="c1"># notice how the data obtains the &quot;right&quot; values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2018-01-04</th>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2018-01-05</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2018-01-07</th>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2018-01-08</th>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pandas has many other interpolation methods, based on SciPy’s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_inter_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">],</span>
                           <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">12.2</span><span class="p">,</span> <span class="mf">14.4</span><span class="p">]})</span>
<span class="n">df_inter_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.7</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.6</td>
      <td>12.20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.8</td>
      <td>14.40</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_inter_2</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.100000</td>
      <td>-2.703846</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.451351</td>
      <td>-1.453846</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.700000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.600000</td>
      <td>12.200000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.800000</td>
      <td>14.400000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="missing-values-in-non-float-columns">
<h3>Missing Values in Non-Float Columns<a class="headerlink" href="#missing-values-in-non-float-columns" title="Permalink to this headline">¶</a></h3>
<p>Starting from pandas v1.0.0 pandas gained support for NaN values in non-float columns. This feature is a bit experimental currently, so the default behavior still converts integers to floats for example, but the support is there if you know where to look. By default:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nanint</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">nanint</span>  <span class="c1"># the result has a dtype of float64 even though all numbers are integers.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.0
1    2.0
2    NaN
3    4.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can try to force pandas’ hand here, but it won’t work:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nanint</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">70</span><span class="o">-</span><span class="n">f1daddd69d17</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">nanint</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/series.py</span> in <span class="ni">__init__</span><span class="nt">(self, data, index, dtype, name, copy, fastpath)</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>                     <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">335</span>                 <span class="n">data</span> <span class="o">=</span> <span class="n">sanitize_array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="p">,</span> <span class="n">raise_cast_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span> 
<span class="g g-Whitespace">    </span><span class="mi">337</span>                 <span class="n">data</span> <span class="o">=</span> <span class="n">SingleBlockManager</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/construction.py</span> in <span class="ni">sanitize_array</span><span class="nt">(data, index, dtype, copy, raise_cast_failure)</span>
<span class="g g-Whitespace">    </span><span class="mi">478</span> 
<span class="g g-Whitespace">    </span><span class="mi">479</span>         <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">480</span>             <span class="n">subarr</span> <span class="o">=</span> <span class="n">_try_cast</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="p">,</span> <span class="n">raise_cast_failure</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">481</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">482</span>             <span class="n">subarr</span> <span class="o">=</span> <span class="n">maybe_convert_platform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/construction.py</span> in <span class="ni">_try_cast</span><span class="nt">(arr, dtype, copy, raise_cast_failure)</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span>         <span class="k">if</span> <span class="n">is_integer_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span>             <span class="c1"># this will raise if we have e.g. floats</span>
<span class="ne">--&gt; </span><span class="mi">587</span>             <span class="n">maybe_cast_to_integer_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span>             <span class="n">subarr</span> <span class="o">=</span> <span class="n">arr</span>
<span class="g g-Whitespace">    </span><span class="mi">589</span>         <span class="k">else</span><span class="p">:</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/dtypes/cast.py</span> in <span class="ni">maybe_cast_to_integer_array</span><span class="nt">(arr, dtype, copy)</span>
<span class="g g-Whitespace">   </span><span class="mi">1721</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1722</span>         <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s2">&quot;astype&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1723</span>             <span class="n">casted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1724</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1725</span>             <span class="n">casted</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

<span class="ne">ValueError</span>: cannot convert float NaN to integer
</pre></div>
</div>
</div>
</div>
<p>To our rescue comes the new <code class="docutils literal notranslate"><span class="pre">pd.Int32Dtype</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nanint</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int32&quot;</span><span class="p">)</span>
<span class="n">nanint</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       1
1       2
2    &lt;NA&gt;
3       4
dtype: Int32
</pre></div>
</div>
</div>
</div>
<p>It worked! We have a series with integers and a missing value! Notice the changes we had to made:</p>
<ol class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">NaN</span></code> is <code class="docutils literal notranslate"><span class="pre">&lt;NA&gt;</span></code> now. It’s actually a new type of <code class="docutils literal notranslate"><span class="pre">NaN</span></code> called <code class="docutils literal notranslate"><span class="pre">pd.NA</span></code>.</p></li>
<li><p>The data type had to be mentioned explictly, meaning that the conversion will work only if we know in advance that we’ll have NA values.</p></li>
<li><p>The data type is <code class="docutils literal notranslate"><span class="pre">Int32</span></code>. It’s CamelCase and it’s actually a class underneath. Standard datatypes are lowercase.</p></li>
</ol>
<p>Caveats aside, this is definitely useful for scientists who sometimes have integer values and do not want to convert them to float to supports NAs.</p>
</div>
</div>
<div class="section" id="categorical-data">
<h2>Categorical Data<a class="headerlink" href="#categorical-data" title="Permalink to this headline">¶</a></h2>
<p>I’d like to discuss one more data type - <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html"><strong>categorical</strong> data</a>. Most data we’ve been working on is ‘quantitative’ in its nature i.e. integers and real numbers can hold (in general terms) any value. But some data can only have one of a specific set, or categories, of data. For example, if we have a column which marks the weekday, then it can obviously only be one of seven options. Same for boolean data, colors, and other examples. These data columns should be marked as “categorical” to reduce memory consumption and improve performance. It also tells the code readers more about the nature of that data column.</p>
<p>The easiest way to create a categorical variable is to declare it as such, or to convert as existing column to a categorical data type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    a
1    b
2    c
3    a
dtype: category
Categories (3, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">]})</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns&#39; data types:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DataFrame:
    A  B
0  a  a
1  b  b
2  c  c
3  a  a
Columns&#39; data types:
 A      object
B    category
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can also force order between our categories, or force specific categories on our data, using the special CategoricalDtype (which we won’t show).</p>
<p>As we said, memory usage is reduced when working with categorical data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10_000</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10_000</span><span class="p">})</span>
<span class="n">df_obj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.040435</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.665366</td>
      <td>a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.076690</td>
      <td>a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.346332</td>
      <td>a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.019470</td>
      <td>a</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>0.576298</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>0.057178</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>0.768620</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>0.233202</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>0.686848</td>
      <td>a</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">df_obj</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)})</span>
<span class="n">df_cat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.040435</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.665366</td>
      <td>a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.076690</td>
      <td>a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.346332</td>
      <td>a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.019470</td>
      <td>a</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>0.576298</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>0.057178</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>0.768620</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>0.233202</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>0.686848</td>
      <td>a</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_obj</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index      128
a        80000
b        80000
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cat</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index      128
a        80000
b        10116
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>A factor of 8 in memory reduction.</p>
</div>
<div class="section" id="hierarchical-indexing">
<h2><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html">Hierarchical Indexing</a><a class="headerlink" href="#hierarchical-indexing" title="Permalink to this headline">¶</a></h2>
<p>Last time we mentioned that while a DataFrame is inherently a 2D object, it can contain multi-dimensional data. The way a DataFrame (and a Series) does that is with Hierarchical Indexing, or sometimes Multi-Indexing.</p>
<p>After the deprecation of <code class="docutils literal notranslate"><span class="pre">pd.Panel</span></code>, this is the only remaining way to represent data of higher dimensions in pandas, making it a very useful tool for data science.</p>
<div class="section" id="simple-example-temperature-in-a-grid">
<h3>Simple Example - Temperature in a Grid<a class="headerlink" href="#simple-example-temperature-in-a-grid" title="Permalink to this headline">¶</a></h3>
<p>Let’s assume I wish to represent points on a 2D grid, perhaps inside a square, that represent the temperature in different locations around this grid. The obvious way to do this is to define a set of two coordinates, <span class="math notranslate nohighlight">\((x, y)\)</span>, which point to a specific location inside my square. These two coordinates should also have a value attached to them - the temperature. A list of such coordinates can be a simple Series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">])</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">),</span> 
          <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">),</span> 
          <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">)]</span>  <span class="c1"># r is row, c is column</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>
<span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(r0, c0)    1.20
(r0, c1)    0.80
(r0, c2)    3.10
(r1, c0)    0.10
(r1, c1)    0.05
(r1, c2)    1.00
(r2, c0)    1.40
(r2, c1)    2.10
(r2, c2)    2.90
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>It is important we understand that this is a series because <em>the data is one-dimensional</em>. The actual data is contained in that rightmost column, a one-dimensional array. We do have two coordinates for each point, but the data itself - the temperature - is one-dimensional.</p>
<p>Currently the index is a simple tuple of coordinates. It’s a single column, containing tuples. Pandas can help us to index this data in a more intuitive manner, using a MultiIndex object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="n">mindex</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;r0&#39;, &#39;c0&#39;),
            (&#39;r0&#39;, &#39;c1&#39;),
            (&#39;r0&#39;, &#39;c2&#39;),
            (&#39;r1&#39;, &#39;c0&#39;),
            (&#39;r1&#39;, &#39;c1&#39;),
            (&#39;r1&#39;, &#39;c2&#39;),
            (&#39;r2&#39;, &#39;c0&#39;),
            (&#39;r2&#39;, &#39;c1&#39;),
            (&#39;r2&#39;, &#39;c2&#39;)],
           )
</pre></div>
</div>
</div>
</div>
<p>We received something which looks quite similar to the list of tuples we had before, but it’s a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.MultiIndex.html"><code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code></a> instance. Let’s see how it helps us by <code class="docutils literal notranslate"><span class="pre">reindex</span></code>ing our data with it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">mindex</span><span class="p">)</span>
<span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r0  c0    1.20
    c1    0.80
    c2    3.10
r1  c0    0.10
    c1    0.05
    c2    1.00
r2  c0    1.40
    c1    2.10
    c2    2.90
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>This looks good. Each index level is represented by a column, with the data being the last one. The “missing” values indicate that the value in that cell is the same as the value above it.</p>
<p>You might have assumed that accessing the data now is much more intuitive. Let’s look at the values of all the points in the first row, <code class="docutils literal notranslate"><span class="pre">r0</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># .loc() is label-based indexing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r0  c0    1.2
    c1    0.8
    c2    3.1
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Or the values of points in the second column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;c1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r0    0.80
r1    0.05
r2    2.10
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span>  <span class="c1"># all values - each level of the index has its own colon (:)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r0  c0    1.20
    c1    0.80
    c2    3.10
r1  c0    0.10
    c1    0.05
    c2    1.00
r2  c0    1.40
    c1    2.10
    c2    2.90
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> disregards the MultiIndex, treating our data as a simple one-dimensional vector (as it actually is):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="c1"># points.iloc[0, 1]  # ERRORS</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4
</pre></div>
</div>
</div>
</div>
<p>Besides making the syntax cleaner, these slicing operations are as efficient as their single-dimension counterparts.</p>
<p>It should be clear that a MultiIndex can have more than two levels. Modelling a 3D cube (with the temperatures inside it) is as easy as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> 
                     <span class="mf">3.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> 
                     <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> 
                     <span class="mf">1.4</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> 
                     <span class="mf">2.9</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span>
                     <span class="mf">2.4</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">])</span>
<span class="c1"># 3D coordinates with a shape of (r, c, z) = (3, 2, 2)</span>
<span class="n">coords3d</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="s1">&#39;z0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="s1">&#39;z1&#39;</span><span class="p">),</span> 
            <span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;z0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;z1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="s1">&#39;z0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="s1">&#39;z1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;z0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;z1&#39;</span><span class="p">),</span> 
            <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="s1">&#39;z0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="s1">&#39;z1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;z0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;z1&#39;</span><span class="p">)]</span>  <span class="c1"># we&#39;ll soon see an easier way to create this index</span>
<span class="n">cube</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values3d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">coords3d</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;temp_cube&#39;</span><span class="p">)</span>
<span class="n">cube</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r0  c0  z0    1.20
        z1    0.80
    c1  z0    3.10
        z1    0.10
r1  c0  z0    0.05
        z1    1.00
    c1  z0    1.40
        z1    2.10
r2  c0  z0    2.90
        z1    0.30
    c1  z0    2.40
        z1    1.90
Name: temp_cube, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can even name the individual levels, which helps with some slicing operations we’ll see below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
<span class="n">cube</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x   y   z 
r0  c0  z0    1.20
        z1    0.80
    c1  z0    3.10
        z1    0.10
r1  c0  z0    0.05
        z1    1.00
    c1  z0    1.40
        z1    2.10
r2  c0  z0    2.90
        z1    0.30
    c1  z0    2.40
        z1    1.90
Name: temp_cube, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Again, you have to remember that this is one-dimensional data, with a three-dimensional index. In statistical term, we might term the indices a fixed, independent categorical variable, while the values are the dependent variable. Pandas actually has a <code class="docutils literal notranslate"><span class="pre">CategoricalIndex</span></code> object which you’ll meet in some future HW.</p>
</div>
<div class="section" id="more-on-extra-dimensions">
<h3>More on extra dimensions<a class="headerlink" href="#more-on-extra-dimensions" title="Permalink to this headline">¶</a></h3>
<p>In the previous square example, it’s very appealing to ditch the MultiIndex altogether and just work with a DataFrame, or even a simple numpy array. This is because the two indices represented rows and columns. A quick way to turn one representation into the other is the <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/reshaping.html"><code class="docutils literal notranslate"><span class="pre">stack()</span></code>\<code class="docutils literal notranslate"><span class="pre">unstack()</span></code></a> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rows&#39;</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">]</span>
<span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rows  columns
r0    c0         1.20
      c1         0.80
      c2         3.10
r1    c0         0.10
      c1         0.05
      c2         1.00
r2    c0         1.40
      c1         2.10
      c2         2.90
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pts_df</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">pts_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>columns</th>
      <th>c0</th>
      <th>c1</th>
      <th>c2</th>
    </tr>
    <tr>
      <th>rows</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>r0</th>
      <td>1.2</td>
      <td>0.80</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>r1</th>
      <td>0.1</td>
      <td>0.05</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>r2</th>
      <td>1.4</td>
      <td>2.10</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pts_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>  <span class="c1"># back to a series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rows  columns
r0    c0         1.20
      c1         0.80
      c2         3.10
r1    c0         0.10
      c1         0.05
      c2         1.00
r2    c0         1.40
      c1         2.10
      c2         2.90
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If we want to turn the indices into “real” columns, we can use the <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pts_df_reset</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">pts_df_reset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rows</th>
      <th>columns</th>
      <th>temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>r0</td>
      <td>c0</td>
      <td>1.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>r0</td>
      <td>c1</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>r0</td>
      <td>c2</td>
      <td>3.10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>r1</td>
      <td>c0</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>r1</td>
      <td>c1</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>r1</td>
      <td>c2</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>r2</td>
      <td>c0</td>
      <td>1.40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>r2</td>
      <td>c1</td>
      <td>2.10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>r2</td>
      <td>c2</td>
      <td>2.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So why bother with these (you haven’t seen nothing yet) complicated multi-indices?</p>
<p>As you might have guessed, adding data points, i.e. increasing the dimensionality of the data, is very easy and intuitive. Data remains aligned through addition and deletion of data. Moreover, treating these categorical variables as an index can help the mental modeling of the problem, especially when you wish to perform statistical modeling with your analysis.</p>
<p>If you’re not convinced yet, I’m sure that in a couple of examples you’ll see their true power unfold.</p>
<div style="text-align:center"><img src="https://media1.tenor.com/images/f4f1826873b424a2aedd57432b48e2fc/tenor.gif?itemid=12243212" /></div>
</div>
<div class="section" id="constructing-a-multiindex">
<h3>Constructing a MultiIndex<a class="headerlink" href="#constructing-a-multiindex" title="Permalink to this headline">¶</a></h3>
<p>Creating a hierarchical index can be done in several ways:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;a&#39;, 1),
            (&#39;a&#39;, 2),
            (&#39;b&#39;, 1),
            (&#39;b&#39;, 2)],
           )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;a&#39;, 1),
            (&#39;a&#39;, 2),
            (&#39;b&#39;, 1),
            (&#39;b&#39;, 2)],
           )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># Cartesian product</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;a&#39;, 1),
            (&#39;a&#39;, 2),
            (&#39;b&#39;, 1),
            (&#39;b&#39;, 2)],
           )
</pre></div>
</div>
</div>
</div>
<p>The most common way to construct a MultiIndex, though, is to add to the existing index one of the columns of the DataFrame. We’ll see how it’s done below.</p>
<p>Another important note is that with DataFrames, the column and row index is symmetric. In effect this means that  the columns could also contain a MultiIndex:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                                   <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;visit&#39;</span><span class="p">])</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Guido&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Temp&#39;</span><span class="p">]],</span>
                                     <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">])</span>

<span class="c1"># mock some data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="n">data</span> <span class="o">+=</span> <span class="mi">37</span>

<span class="c1"># create the DataFrame</span>
<span class="n">health_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">health_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>36.0</td>
      <td>35.2</td>
      <td>37.0</td>
      <td>36.5</td>
      <td>43.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>55.0</td>
      <td>38.6</td>
      <td>37.0</td>
      <td>39.0</td>
      <td>20.0</td>
      <td>36.2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>26.0</td>
      <td>37.1</td>
      <td>44.0</td>
      <td>36.1</td>
      <td>22.0</td>
      <td>37.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32.0</td>
      <td>37.3</td>
      <td>33.0</td>
      <td>35.3</td>
      <td>47.0</td>
      <td>37.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This sometimes might seem too much, and so usually people prefer to keep the column index as a simple list of names, moving any nestedness to the row index. This is due to the fact that usually columns represent the measured dependent variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Guido&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">]],</span>
                                   <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;visit&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">])</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Temp&#39;</span><span class="p">]</span>

<span class="c1"># mock some data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="n">data</span> <span class="o">+=</span> <span class="mi">37</span>

<span class="c1"># create the DataFrame</span>
<span class="n">health_data_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">health_data_row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th>subject</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">2013</th>
      <th rowspan="3" valign="top">1</th>
      <th>Bob</th>
      <td>43.0</td>
      <td>35.2</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>28.0</td>
      <td>37.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>47.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2</th>
      <th>Bob</th>
      <td>35.0</td>
      <td>37.6</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>47.0</td>
      <td>36.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>28.0</td>
      <td>36.7</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">2014</th>
      <th rowspan="3" valign="top">1</th>
      <th>Bob</th>
      <td>39.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>50.0</td>
      <td>34.5</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>31.0</td>
      <td>36.7</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2</th>
      <th>Bob</th>
      <td>26.0</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>34.0</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>55.0</td>
      <td>36.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="creating-a-multiindex-from-a-data-column">
<h4>Creating a MultiIndex from a data column<a class="headerlink" href="#creating-a-multiindex-from-a-data-column" title="Permalink to this headline">¶</a></h4>
<p>While all of the above methods work, and could be useful sometimes, the most common method of creating an index is from an existing data column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">location</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;NY&#39;</span><span class="p">,</span> <span class="s1">&#39;NY&#39;</span><span class="p">,</span> <span class="s1">&#39;NY&#39;</span><span class="p">,</span> <span class="s1">&#39;VA&#39;</span><span class="p">]</span>
<span class="n">day</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SUN&#39;</span><span class="p">,</span> <span class="s1">&#39;SUN&#39;</span><span class="p">,</span> <span class="s1">&#39;TUE&#39;</span><span class="p">,</span> <span class="s1">&#39;WED&#39;</span><span class="p">,</span> <span class="s1">&#39;SAT&#39;</span><span class="p">,</span> <span class="s1">&#39;SAT&#39;</span><span class="p">]</span>
<span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">12.3</span><span class="p">,</span> <span class="mf">14.1</span><span class="p">,</span> <span class="mf">21.3</span><span class="p">,</span> <span class="mf">20.9</span><span class="p">,</span> <span class="mf">18.8</span><span class="p">,</span> <span class="mf">16.5</span><span class="p">]</span>
<span class="n">humidity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">52</span><span class="p">]</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="n">day</span><span class="p">,</span> 
                           <span class="n">temp</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span> <span class="n">humidity</span><span class="o">=</span><span class="n">humidity</span><span class="p">))</span>
<span class="n">states</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>location</th>
      <th>day</th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>SUN</td>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>SUN</td>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NY</td>
      <td>TUE</td>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NY</td>
      <td>WED</td>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NY</td>
      <td>SAT</td>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>5</th>
      <td>VA</td>
      <td>SAT</td>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;day&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>location</th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th>day</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SUN</th>
      <td>AL</td>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>SUN</th>
      <td>AL</td>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>TUE</th>
      <td>NY</td>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>WED</th>
      <td>NY</td>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th>SAT</th>
      <td>NY</td>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>SAT</th>
      <td>VA</td>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th>day</th>
      <th>location</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">SUN</th>
      <th>AL</th>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>AL</th>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>TUE</th>
      <th>NY</th>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>WED</th>
      <th>NY</th>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">SAT</th>
      <th>NY</th>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>VA</th>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">],</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th></th>
      <th>day</th>
      <th>location</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>SUN</th>
      <th>AL</th>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>1</th>
      <th>SUN</th>
      <th>AL</th>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>2</th>
      <th>TUE</th>
      <th>NY</th>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>3</th>
      <th>WED</th>
      <th>NY</th>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th>4</th>
      <th>SAT</th>
      <th>NY</th>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>5</th>
      <th>SAT</th>
      <th>VA</th>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">set_index</span><span class="p">([[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;iii&#39;</span><span class="p">,</span> <span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;vi&#39;</span><span class="p">],</span> <span class="s1">&#39;day&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>location</th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th></th>
      <th>day</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>i</th>
      <th>SUN</th>
      <td>AL</td>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>ii</th>
      <th>SUN</th>
      <td>AL</td>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>iii</th>
      <th>TUE</th>
      <td>NY</td>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>iv</th>
      <th>WED</th>
      <td>NY</td>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th>v</th>
      <th>SAT</th>
      <td>NY</td>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>vi</th>
      <th>SAT</th>
      <td>VA</td>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="indexing-and-slicing-a-multiindex">
<h3>Indexing and Slicing a MultiIndex<a class="headerlink" href="#indexing-and-slicing-a-multiindex" title="Permalink to this headline">¶</a></h3>
<p>We’ll use these DFs as an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>36.0</td>
      <td>35.2</td>
      <td>37.0</td>
      <td>36.5</td>
      <td>43.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>55.0</td>
      <td>38.6</td>
      <td>37.0</td>
      <td>39.0</td>
      <td>20.0</td>
      <td>36.2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>26.0</td>
      <td>37.1</td>
      <td>44.0</td>
      <td>36.1</td>
      <td>22.0</td>
      <td>37.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32.0</td>
      <td>37.3</td>
      <td>33.0</td>
      <td>35.3</td>
      <td>47.0</td>
      <td>37.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data_row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th>subject</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">2013</th>
      <th rowspan="3" valign="top">1</th>
      <th>Bob</th>
      <td>43.0</td>
      <td>35.2</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>28.0</td>
      <td>37.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>47.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2</th>
      <th>Bob</th>
      <td>35.0</td>
      <td>37.6</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>47.0</td>
      <td>36.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>28.0</td>
      <td>36.7</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">2014</th>
      <th rowspan="3" valign="top">1</th>
      <th>Bob</th>
      <td>39.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>50.0</td>
      <td>34.5</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>31.0</td>
      <td>36.7</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2</th>
      <th>Bob</th>
      <td>26.0</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>34.0</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>55.0</td>
      <td>36.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If all we wish to do is to examine a column, indexing is very easy. Don’t forget the DataFrame as dictionary analogy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span><span class="p">[</span><span class="s1">&#39;Guido&#39;</span><span class="p">]</span>  <span class="c1"># works for the column MultiIndex as expected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>37.0</td>
      <td>36.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37.0</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>44.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>33.0</td>
      <td>35.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data_row</span><span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">]</span>  <span class="c1"># that&#39;s a Series!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year  visit  subject
2013  1      Bob        43.0
             Guido      28.0
             Sue        47.0
      2      Bob        35.0
             Guido      47.0
             Sue        28.0
2014  1      Bob        39.0
             Guido      50.0
             Sue        31.0
      2      Bob        26.0
             Guido      34.0
             Sue        55.0
Name: HR, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accessing single elements is also pretty straight-forward</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Guido&#39;</span><span class="p">]</span>  <span class="c1"># index triplet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HR      28.0
Temp    37.3
Name: (2013, 1, Guido), dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can even slice easily using the first MultiIndex (year in our case)</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2013</span><span class="p">:</span><span class="mi">2017</span><span class="p">]</span>  <span class="c1"># 2017 doesn&#39;t exist, but Python&#39;s slicing rules prevent an exception here</span>
<span class="c1"># health_data_row.loc[1]  # doesn&#39;t work</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th>subject</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">2013</th>
      <th rowspan="3" valign="top">1</th>
      <th>Bob</th>
      <td>43.0</td>
      <td>35.2</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>28.0</td>
      <td>37.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>47.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2</th>
      <th>Bob</th>
      <td>35.0</td>
      <td>37.6</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>47.0</td>
      <td>36.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>28.0</td>
      <td>36.7</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">2014</th>
      <th rowspan="3" valign="top">1</th>
      <th>Bob</th>
      <td>39.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>50.0</td>
      <td>34.5</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>31.0</td>
      <td>36.7</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2</th>
      <th>Bob</th>
      <td>26.0</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>34.0</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>55.0</td>
      <td>36.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Slicing is a bit more difficult when we want to take into account all available indices. This is due to the possible conflicts between the different indices and the columns.</p>
<p>Assuming we want to look at all the years, with all the visits, only by Bob - we would want to write something like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[(:,</span> <span class="p">:,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">),</span> <span class="p">:]</span>  <span class="c1"># doesn&#39;t work</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;&lt;ipython-input-107-55ad5b04417a&gt;&quot;</span><span class="gt">, line </span><span class="mi">1</span>
    <span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[(:,</span> <span class="p">:,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">),</span> <span class="p">:]</span>  <span class="c1"># doesn&#39;t work</span>
                         <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<p>This pickle is solved in two possible ways:</p>
<p>First option - the <a class="reference external" href="https://www.programiz.com/python-programming/methods/built-in/slice">slice</a> object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bobs_data</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="s1">&#39;Bob&#39;</span><span class="p">)</span>  <span class="c1"># all years, all visits, of Bob</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bobs_data</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">]</span>
<span class="c1"># arr[slice(None), 1] is the same as arr[:, 1]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year  visit  subject
2013  1      Bob        43.0
      2      Bob        35.0
2014  1      Bob        39.0
      2      Bob        26.0
Name: HR, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Guido&#39;</span><span class="p">))</span>  <span class="c1"># all years, all visits, Bob + Guido</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year  visit  subject
2013  1      Bob        43.0
             Guido      28.0
      2      Bob        35.0
             Guido      47.0
2014  1      Bob        39.0
             Guido      50.0
      2      Bob        26.0
             Guido      34.0
Name: HR, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Second option - the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.IndexSlice.html">IndexSlice</a> object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span> <span class="p">:,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">],</span> <span class="p">:]</span>  <span class="c1"># very close to the naive implementation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th>subject</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <th>Bob</th>
      <td>43.0</td>
      <td>35.2</td>
    </tr>
    <tr>
      <th>2</th>
      <th>Bob</th>
      <td>35.0</td>
      <td>37.6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <th>Bob</th>
      <td>39.0</td>
      <td>36.1</td>
    </tr>
    <tr>
      <th>2</th>
      <th>Bob</th>
      <td>26.0</td>
      <td>38.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx2</span><span class="p">[</span><span class="mi">2013</span><span class="p">:</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">:</span><span class="s1">&#39;Guido&#39;</span><span class="p">],</span> <span class="s1">&#39;Temp&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year  visit  subject
2013  1      Bob        35.2
             Guido      37.3
2014  1      Bob        36.1
             Guido      34.5
Name: Temp, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>There’s one more way to index into a MultiIndex, which is very straight-forward and explicit when you’re looking for specific values: The <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.xs.html">cross-section</a> -</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third option - the cross-section - returns specific values</span>
<span class="n">health_data_row</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;visit&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>subject</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>43.0</td>
      <td>35.2</td>
    </tr>
    <tr>
      <th>Guido</th>
      <td>28.0</td>
      <td>37.3</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>47.0</td>
      <td>37.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="small-caveat-unsorted-indices">
<h4>Small caveat - unsorted indices<a class="headerlink" href="#small-caveat-unsorted-indices" title="Permalink to this headline">¶</a></h4>
<p>Having an unsorted index in your MultiIndex might make the interpreter pop a few exceptions at you:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># char index in unsorted</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;char&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>char  int
a     1      0.825630
      2      0.463276
c     1      0.239827
      2      0.032947
b     1      0.411629
      2      0.964536
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">UnsortedIndexError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">114</span><span class="o">-</span><span class="mf">0e6568674</span><span class="n">d17</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/series.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">846</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_values</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">847</span> 
<span class="ne">--&gt; </span><span class="mi">848</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_with</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">849</span> 
<span class="g g-Whitespace">    </span><span class="mi">850</span>     <span class="k">def</span> <span class="nf">_get_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/series.py</span> in <span class="ni">_get_with</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">853</span>             <span class="c1"># _convert_slice_indexer to determine if this slice is positional</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span>             <span class="c1">#  or label based, and if the latter, convert to positional</span>
<span class="ne">--&gt; </span><span class="mi">855</span>             <span class="n">slobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">_convert_slice_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;getitem&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">856</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice</span><span class="p">(</span><span class="n">slobj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>         <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ABCDataFrame</span><span class="p">):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/indexes/base.py</span> in <span class="ni">_convert_slice_indexer</span><span class="nt">(self, key, kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">3388</span>             <span class="n">indexer</span> <span class="o">=</span> <span class="n">key</span>
<span class="g g-Whitespace">   </span><span class="mi">3389</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3390</span>             <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_indexer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3391</span> 
<span class="g g-Whitespace">   </span><span class="mi">3392</span>         <span class="k">return</span> <span class="n">indexer</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/indexes/base.py</span> in <span class="ni">slice_indexer</span><span class="nt">(self, start, end, step, kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">5275</span>         <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5276</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">5277</span><span class="s2">         start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">5278</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">5279</span><span class="s2">         # return a slice</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/indexes/multi.py</span> in <span class="ni">slice_locs</span><span class="nt">(self, start, end, step, kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">2743</span><span class="s2">         # This function adds nothing to its parent implementation (the magic</span>
<span class="g g-Whitespace">   </span><span class="mi">2744</span><span class="s2">         # happens in get_slice_bound method), but it adds meaningful doc.</span>
<span class="ne">-&gt; </span><span class="mi">2745</span><span class="s2">         return super().slice_locs(start, end, step, kind=kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">2746</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2747</span><span class="s2">     def _partial_tup_index(self, tup, side=&quot;left&quot;):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/indexes/base.py</span> in <span class="ni">slice_locs</span><span class="nt">(self, start, end, step, kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">5474</span><span class="s2">         start_slice = None</span>
<span class="g g-Whitespace">   </span><span class="mi">5475</span><span class="s2">         if start is not None:</span>
<span class="ne">-&gt; </span><span class="mi">5476</span><span class="s2">             start_slice = self.get_slice_bound(start, &quot;left&quot;, kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">5477</span><span class="s2">         if start_slice is None:</span>
<span class="g g-Whitespace">   </span><span class="mi">5478</span><span class="s2">             start_slice = 0</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/indexes/multi.py</span> in <span class="ni">get_slice_bound</span><span class="nt">(self, label, side, kind)</span>
<span class="g g-Whitespace">   </span><span class="mi">2687</span><span class="s2">         if not isinstance(label, tuple):</span>
<span class="g g-Whitespace">   </span><span class="mi">2688</span><span class="s2">             label = (label,)</span>
<span class="ne">-&gt; </span><span class="mi">2689</span><span class="s2">         return self._partial_tup_index(label, side=side)</span>
<span class="g g-Whitespace">   </span><span class="mi">2690</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2691</span><span class="s2">     def slice_locs(self, start=None, end=None, step=None, kind=None):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/core/indexes/multi.py</span> in <span class="ni">_partial_tup_index</span><span class="nt">(self, tup, side)</span>
<span class="g g-Whitespace">   </span><span class="mi">2747</span><span class="s2">     def _partial_tup_index(self, tup, side=&quot;left&quot;):</span>
<span class="g g-Whitespace">   </span><span class="mi">2748</span><span class="s2">         if len(tup) &gt; self.lexsort_depth:</span>
<span class="ne">-&gt; </span><span class="mi">2749</span><span class="s2">             raise UnsortedIndexError(</span>
<span class="g g-Whitespace">   </span><span class="mi">2750</span><span class="s2">                 f&quot;Key length ({len(tup)}) was greater than MultiIndex lexsort depth &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2751</span><span class="s2">                 f&quot;(</span><span class="si">{self.lexsort_depth}</span><span class="s2">)&quot;</span>

<span class="ne">UnsortedIndexError</span>: &#39;Key length (1) was greater than MultiIndex lexsort depth (0)&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lexsort</span></code> means “lexicography-sorted”, or sorted by either number or letter. Sorting an index is done with the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_index.html"><code class="docutils literal notranslate"><span class="pre">sort_index()</span></code></a> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>  <span class="c1"># now it works</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>char  int
a     1      0.825630
      2      0.463276
b     1      0.411629
      2      0.964536
c     1      0.239827
      2      0.032947
dtype: float64
char  int
a     1      0.825630
      2      0.463276
b     1      0.411629
      2      0.964536
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-aggregation">
<h3>Data Aggregation<a class="headerlink" href="#data-aggregation" title="Permalink to this headline">¶</a></h3>
<p>Data aggregation using a MultiIndex is amazingly simple:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>location</th>
      <th>day</th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>SUN</td>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>SUN</td>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NY</td>
      <td>TUE</td>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NY</td>
      <td>WED</td>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NY</td>
      <td>SAT</td>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>5</th>
      <td>VA</td>
      <td>SAT</td>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">states</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th>location</th>
      <th>day</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">AL</th>
      <th>SUN</th>
      <td>12.3</td>
      <td>31</td>
    </tr>
    <tr>
      <th>SUN</th>
      <td>14.1</td>
      <td>45</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">NY</th>
      <th>TUE</th>
      <td>21.3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>WED</th>
      <td>20.9</td>
      <td>41</td>
    </tr>
    <tr>
      <th>SAT</th>
      <td>18.8</td>
      <td>49</td>
    </tr>
    <tr>
      <th>VA</th>
      <th>SAT</th>
      <td>16.5</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;location&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th>location</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AL</th>
      <td>13.200000</td>
      <td>38.000000</td>
    </tr>
    <tr>
      <th>NY</th>
      <td>20.333333</td>
      <td>43.666667</td>
    </tr>
    <tr>
      <th>VA</th>
      <td>16.500000</td>
      <td>52.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temp</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th>day</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SUN</th>
      <td>13.20</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>TUE</th>
      <td>21.30</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>WED</th>
      <td>20.90</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>SAT</th>
      <td>17.65</td>
      <td>50.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><em>Missing Data:</em> Sample data sparsely from a sine wave. To do so:</p>
<ol class="simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(10000,)</span></code> 10-period sine wave. Remember that a single period of sine starts at 0 and ends at 2<span class="math notranslate nohighlight">\(\pi\)</span>, so 10 periods span between 0 and 20<span class="math notranslate nohighlight">\(\pi\)</span>.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">np.random.choice(replace=False)</span></code> sample 100 points from the wave and place them in a Series.</p></li>
<li><p>Plot the chosen points.</p></li>
<li><p>Interpolate the points using linear interpolation and plot them on a different graph.</p></li>
<li><p>Interpolate the points using quadratic interpolation and plot them on a different graph.</p></li>
</ol>
</li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">num_periods</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_reps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">amp</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">num_periods</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num_reps</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>

<span class="n">chosen_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">num_reps</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">chosen_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">chosen_idx</span><span class="p">]</span>

<span class="c1"># plotting</span>
<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Raw data pre-interpolation&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;lin_inter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear interpolation&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">lin_inter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;quad_inter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;quadratic&#39;</span><span class="p">)</span>
<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quadratic interpolation&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">quad_inter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0b7e0d4470&gt;
</pre></div>
</div>
<img alt="../../_images/class_6_172_1.png" src="../../_images/class_6_172_1.png" />
<img alt="../../_images/class_6_172_2.png" src="../../_images/class_6_172_2.png" />
<img alt="../../_images/class_6_172_3.png" src="../../_images/class_6_172_3.png" />
</div>
</div>
<ol class="simple">
<li><p><em>Replace Values:</em> When we wish to replace values in a Series or DataFrame, we can do so in two main ways. The first, and most common, is a simple boolean masked, which we’ve already covered. The second method is the <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> method of a Series\DataFrame.</p>
<ul class="simple">
<li><p>Create a (10, 2) dataframe with increasing integer values 0-9 in both columns.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> method to replace the value 3 in the first column with 99.</p></li>
<li><p>Use it to replace 3 in column 0, and 1 in column 2, with 99.</p></li>
<li><p>Use its <code class="docutils literal notranslate"><span class="pre">method</span></code> keyword to replace values in the range [3, 6) of the first column with 6.</p></li>
</ul>
</li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">99</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">99</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>99</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0
1    1
2    2
3    6
4    6
5    6
6    6
7    7
8    8
9    9
Name: 0, dtype: int64
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p><em>MultiIndex #1:</em> Construct a MultiIndex with 3 levels as the product of the following values: <code class="docutils literal notranslate"><span class="pre">(['a',</span> <span class="pre">b',</span> <span class="pre">'c',</span> <span class="pre">'d'],</span> <span class="pre">['i',</span> <span class="pre">'ii',</span> <span class="pre">'iii'],</span> <span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z'])</span></code>. Populate the DataFrame with random values in two columns.</p>
<ul class="simple">
<li><p>Extract in two different methods only the values with an index of <code class="docutils literal notranslate"><span class="pre">('a',</span> <span class="pre">'ii',</span> <span class="pre">'z')</span></code>.</p></li>
<li><p>Slice in two ways the values with an index of <code class="docutils literal notranslate"><span class="pre">'x'</span></code>.</p></li>
</ul>
</li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">letters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">roman</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;iii&#39;</span><span class="p">]</span>
<span class="n">coor</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">((</span><span class="n">letters</span><span class="p">,</span> <span class="n">roman</span><span class="p">,</span> <span class="n">coor</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">roman</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">coor</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;today&#39;</span><span class="p">,</span> <span class="s1">&#39;tomorrow&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>today</th>
      <th>tomorrow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="9" valign="top">a</th>
      <th rowspan="3" valign="top">i</th>
      <th>x</th>
      <td>5</td>
      <td>14</td>
    </tr>
    <tr>
      <th>y</th>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>z</th>
      <td>0</td>
      <td>9</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ii</th>
      <th>x</th>
      <td>10</td>
      <td>17</td>
    </tr>
    <tr>
      <th>y</th>
      <td>19</td>
      <td>12</td>
    </tr>
    <tr>
      <th>z</th>
      <td>1</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">iii</th>
      <th>x</th>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>y</th>
      <td>13</td>
      <td>15</td>
    </tr>
    <tr>
      <th>z</th>
      <td>15</td>
      <td>10</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">b</th>
      <th rowspan="3" valign="top">i</th>
      <th>x</th>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>y</th>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>z</th>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ii</th>
      <th>x</th>
      <td>1</td>
      <td>12</td>
    </tr>
    <tr>
      <th>y</th>
      <td>18</td>
      <td>14</td>
    </tr>
    <tr>
      <th>z</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">iii</th>
      <th>x</th>
      <td>2</td>
      <td>14</td>
    </tr>
    <tr>
      <th>y</th>
      <td>4</td>
      <td>12</td>
    </tr>
    <tr>
      <th>z</th>
      <td>13</td>
      <td>11</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">c</th>
      <th rowspan="3" valign="top">i</th>
      <th>x</th>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>y</th>
      <td>1</td>
      <td>19</td>
    </tr>
    <tr>
      <th>z</th>
      <td>16</td>
      <td>18</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ii</th>
      <th>x</th>
      <td>14</td>
      <td>9</td>
    </tr>
    <tr>
      <th>y</th>
      <td>16</td>
      <td>13</td>
    </tr>
    <tr>
      <th>z</th>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">iii</th>
      <th>x</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>y</th>
      <td>17</td>
      <td>8</td>
    </tr>
    <tr>
      <th>z</th>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">d</th>
      <th rowspan="3" valign="top">i</th>
      <th>x</th>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>y</th>
      <td>11</td>
      <td>14</td>
    </tr>
    <tr>
      <th>z</th>
      <td>17</td>
      <td>5</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ii</th>
      <th>x</th>
      <td>0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0</td>
      <td>16</td>
    </tr>
    <tr>
      <th>z</th>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">iii</th>
      <th>x</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>y</th>
      <td>3</td>
      <td>11</td>
    </tr>
    <tr>
      <th>z</th>
      <td>9</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract specific values - 1</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>today       10
tomorrow     3
Name: (a, ii, z), dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract specific values - 2</span>
<span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>today       10
tomorrow     3
Name: (a, ii, z), dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract specific values - 2</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>today       10
tomorrow     3
Name: (a, ii, z), dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract slice - 1</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span> <span class="p">:,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>today</th>
      <th>tomorrow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">a</th>
      <th>i</th>
      <th>x</th>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>ii</th>
      <th>x</th>
      <td>5</td>
      <td>16</td>
    </tr>
    <tr>
      <th>iii</th>
      <th>x</th>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">b</th>
      <th>i</th>
      <th>x</th>
      <td>11</td>
      <td>18</td>
    </tr>
    <tr>
      <th>ii</th>
      <th>x</th>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>iii</th>
      <th>x</th>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">c</th>
      <th>i</th>
      <th>x</th>
      <td>9</td>
      <td>16</td>
    </tr>
    <tr>
      <th>ii</th>
      <th>x</th>
      <td>1</td>
      <td>17</td>
    </tr>
    <tr>
      <th>iii</th>
      <th>x</th>
      <td>15</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">d</th>
      <th>i</th>
      <th>x</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>ii</th>
      <th>x</th>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>iii</th>
      <th>x</th>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract slice - 2</span>
<span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>today</th>
      <th>tomorrow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">a</th>
      <th>i</th>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>ii</th>
      <td>5</td>
      <td>16</td>
    </tr>
    <tr>
      <th>iii</th>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">b</th>
      <th>i</th>
      <td>11</td>
      <td>18</td>
    </tr>
    <tr>
      <th>ii</th>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>iii</th>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">c</th>
      <th>i</th>
      <td>9</td>
      <td>16</td>
    </tr>
    <tr>
      <th>ii</th>
      <td>1</td>
      <td>17</td>
    </tr>
    <tr>
      <th>iii</th>
      <td>15</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">d</th>
      <th>i</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>ii</th>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>iii</th>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="simple">
<li><p><em>MultiIndex #2:</em> Read the CSV from the previous class and parse at least two of its columns as indices. If you identify more columns that fit the role of an index - please make them such.</p>
<ul class="simple">
<li><p>How many entries do you have for each index?</p></li>
<li><p>Aggregate the data based on its mean for each index level.</p></li>
</ul>
</li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reqs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;extra_material/311_service_requests.zip&#39;</span><span class="p">)</span>
<span class="n">reqs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">121</span><span class="o">-</span><span class="n">c55db2d99971</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">reqs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;extra_material/311_service_requests.zip&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">reqs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, dialect, error_bad_lines, warn_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span> 
<span class="ne">--&gt; </span><span class="mi">605</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span> 
<span class="g g-Whitespace">    </span><span class="mi">607</span> 

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> 
<span class="g g-Whitespace">    </span><span class="mi">456</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">457</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span> 
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>             <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">813</span> 
<span class="ne">--&gt; </span><span class="mi">814</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">815</span> 
<span class="g g-Whitespace">    </span><span class="mi">816</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1044</span>         <span class="c1"># error: Too many arguments for &quot;ParserBase&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1045</span>         <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span> 
<span class="g g-Whitespace">   </span><span class="mi">1047</span>     <span class="k">def</span> <span class="nf">_failover_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1860</span> 
<span class="g g-Whitespace">   </span><span class="mi">1861</span>         <span class="c1"># open handles</span>
<span class="ne">-&gt; </span><span class="mi">1862</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_open_handles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1863</span>         <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1864</span>         <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="s2">&quot;compression&quot;</span><span class="p">):</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/parsers.py</span> in <span class="ni">_open_handles</span><span class="nt">(self, src, kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1355</span>         <span class="n">Let</span> <span class="n">the</span> <span class="n">readers</span> <span class="nb">open</span> <span class="n">IOHanldes</span> <span class="n">after</span> <span class="n">they</span> <span class="n">are</span> <span class="n">done</span> <span class="k">with</span> <span class="n">their</span> <span class="n">potential</span> <span class="n">raises</span><span class="o">.</span>
<span class="g g-Whitespace">   </span><span class="mi">1356</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1357</span><span class="s2">         self.handles = get_handle(</span>
<span class="g g-Whitespace">   </span><span class="mi">1358</span><span class="s2">             src,</span>
<span class="g g-Whitespace">   </span><span class="mi">1359</span><span class="s2">             &quot;r&quot;,</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span><span class="s2">         # ZIP Compression</span>
<span class="g g-Whitespace">    </span><span class="mi">607</span><span class="s2">         elif compression == &quot;zip&quot;:</span>
<span class="ne">--&gt; </span><span class="mi">608</span><span class="s2">             handle = _BytesZipFile(handle, ioargs.mode, **compression_args)</span>
<span class="g g-Whitespace">    </span><span class="mi">609</span><span class="s2">             if handle.mode == &quot;r&quot;:</span>
<span class="g g-Whitespace">    </span><span class="mi">610</span><span class="s2">                 handles.append(handle)</span>

<span class="nn">~/Projects/python_for_neuroscientists/venv/lib/python3.8/site-packages/pandas/io/common.py</span> in <span class="ni">__init__</span><span class="nt">(self, file, mode, archive_name, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span><span class="s2">         kwargs_zip: Dict[str, Any] = {&quot;compression&quot;: zipfile.ZIP_DEFLATED}</span>
<span class="g g-Whitespace">    </span><span class="mi">714</span><span class="s2">         kwargs_zip.update(kwargs)</span>
<span class="ne">--&gt; </span><span class="mi">715</span><span class="s2">         super().__init__(file, mode, **kwargs_zip)  # type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">716</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">717</span><span class="s2">     def write(self, data):</span>

<span class="nn">/usr/lib/python3.8/zipfile.py</span> in <span class="ni">__init__</span><span class="nt">(self, file, mode, compression, allowZip64, compresslevel, strict_timestamps)</span>
<span class="g g-Whitespace">   </span><span class="mi">1249</span><span class="s2">             while True:</span>
<span class="g g-Whitespace">   </span><span class="mi">1250</span><span class="s2">                 try:</span>
<span class="ne">-&gt; </span><span class="mi">1251</span><span class="s2">                     self.fp = io.open(file, filemode)</span>
<span class="g g-Whitespace">   </span><span class="mi">1252</span><span class="s2">                 except OSError:</span>
<span class="g g-Whitespace">   </span><span class="mi">1253</span><span class="s2">                     if filemode in modeDict:</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;extra_material/311_service_requests.zip&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reqs</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Agency&#39;</span><span class="p">,</span> <span class="s1">&#39;Complaint Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Descriptor&#39;</span><span class="p">,</span> <span class="s1">&#39;Location Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Bridge Highway Direction&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reqs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency Name</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>Street Name</th>
      <th>Cross Street 1</th>
      <th>Cross Street 2</th>
      <th>Intersection Street 1</th>
      <th>...</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Garage Lot Name</th>
      <th>Ferry Direction</th>
      <th>Ferry Terminal Name</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
    <tr>
      <th>Unnamed: 0</th>
      <th>Agency</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Bridge Highway Direction</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>TLC</th>
      <th>Taxi Compliment</th>
      <th>Driver Compliment</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19574549</td>
      <td>01/11/2011 03:47:18 PM</td>
      <td>07/05/2011 04:08:01 PM</td>
      <td>Correspondence - Taxi and Limousine Commission</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <th>DEP</th>
      <th>Lead</th>
      <th>Lead Kit Request (Residential) (L10)</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19579718</td>
      <td>01/11/2011 03:00:00 AM</td>
      <td>NaN</td>
      <td>Department of Environmental Protection</td>
      <td>10011</td>
      <td>226 WEST 20 STREET</td>
      <td>WEST 20 STREET</td>
      <td>7 AVENUE</td>
      <td>8 AVENUE</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.742622</td>
      <td>-73.997968</td>
      <td>(40.74262244714865, -73.99796826857371)</td>
    </tr>
    <tr>
      <th>2</th>
      <th>TLC</th>
      <th>Taxi Compliment</th>
      <th>Driver Compliment</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19573881</td>
      <td>01/11/2011 11:31:02 AM</td>
      <td>07/05/2011 04:07:58 PM</td>
      <td>Correspondence - Taxi and Limousine Commission</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <th>DEP</th>
      <th>Lead</th>
      <th>Lead Kit Request (Non-Residential) (L11)</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19579917</td>
      <td>01/11/2011 12:46:00 PM</td>
      <td>NaN</td>
      <td>Department of Environmental Protection</td>
      <td>10128</td>
      <td>7 EAST 95 STREET</td>
      <td>EAST 95 STREET</td>
      <td>5 AVENUE</td>
      <td>MADISON AVENUE</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.787046</td>
      <td>-73.955817</td>
      <td>(40.78704587425496, -73.95581736959971)</td>
    </tr>
    <tr>
      <th>4</th>
      <th>DEP</th>
      <th>Lead</th>
      <th>Lead Kit Request (Residential) (L10)</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19580080</td>
      <td>01/11/2011 05:03:00 PM</td>
      <td>NaN</td>
      <td>Department of Environmental Protection</td>
      <td>11208</td>
      <td>721 FOUNTAIN AVENUE</td>
      <td>FOUNTAIN AVENUE</td>
      <td>WORTMAN AVENUE</td>
      <td>COZINE AVENUE</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.662730</td>
      <td>-73.868878</td>
      <td>(40.66272996328775, -73.8688777423775)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 48 columns</p>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reqs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">set_names</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reqs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency Name</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>Street Name</th>
      <th>Cross Street 1</th>
      <th>Cross Street 2</th>
      <th>Intersection Street 1</th>
      <th>...</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Garage Lot Name</th>
      <th>Ferry Direction</th>
      <th>Ferry Terminal Name</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
    <tr>
      <th>num</th>
      <th>Agency</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Bridge Highway Direction</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>TLC</th>
      <th>Taxi Compliment</th>
      <th>Driver Compliment</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19574549</td>
      <td>01/11/2011 03:47:18 PM</td>
      <td>07/05/2011 04:08:01 PM</td>
      <td>Correspondence - Taxi and Limousine Commission</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <th>DEP</th>
      <th>Lead</th>
      <th>Lead Kit Request (Residential) (L10)</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19579718</td>
      <td>01/11/2011 03:00:00 AM</td>
      <td>NaN</td>
      <td>Department of Environmental Protection</td>
      <td>10011</td>
      <td>226 WEST 20 STREET</td>
      <td>WEST 20 STREET</td>
      <td>7 AVENUE</td>
      <td>8 AVENUE</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.742622</td>
      <td>-73.997968</td>
      <td>(40.74262244714865, -73.99796826857371)</td>
    </tr>
    <tr>
      <th>2</th>
      <th>TLC</th>
      <th>Taxi Compliment</th>
      <th>Driver Compliment</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19573881</td>
      <td>01/11/2011 11:31:02 AM</td>
      <td>07/05/2011 04:07:58 PM</td>
      <td>Correspondence - Taxi and Limousine Commission</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <th>DEP</th>
      <th>Lead</th>
      <th>Lead Kit Request (Non-Residential) (L11)</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19579917</td>
      <td>01/11/2011 12:46:00 PM</td>
      <td>NaN</td>
      <td>Department of Environmental Protection</td>
      <td>10128</td>
      <td>7 EAST 95 STREET</td>
      <td>EAST 95 STREET</td>
      <td>5 AVENUE</td>
      <td>MADISON AVENUE</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.787046</td>
      <td>-73.955817</td>
      <td>(40.78704587425496, -73.95581736959971)</td>
    </tr>
    <tr>
      <th>4</th>
      <th>DEP</th>
      <th>Lead</th>
      <th>Lead Kit Request (Residential) (L10)</th>
      <th>NaN</th>
      <th>NaN</th>
      <td>19580080</td>
      <td>01/11/2011 05:03:00 PM</td>
      <td>NaN</td>
      <td>Department of Environmental Protection</td>
      <td>11208</td>
      <td>721 FOUNTAIN AVENUE</td>
      <td>FOUNTAIN AVENUE</td>
      <td>WORTMAN AVENUE</td>
      <td>COZINE AVENUE</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.662730</td>
      <td>-73.868878</td>
      <td>(40.66272996328775, -73.8688777423775)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 48 columns</p>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Different entries for each index</span>
<span class="n">reqs</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique Key                        300000
Created Date                      300000
Closed Date                       258815
Agency Name                       300000
Incident Zip                      292510
Incident Address                  247648
Street Name                       247620
Cross Street 1                    247870
Cross Street 2                    247755
Intersection Street 1              27723
Intersection Street 2              27725
Address Type                      289396
City                              292703
Landmark                             287
Facility Type                      40574
Status                            299999
Due Date                          107631
Resolution Description            270293
Resolution Action Updated Date    286853
Community Board                   300000
Borough                           300000
X Coordinate (State Plane)        275201
Y Coordinate (State Plane)        275201
Park Facility Name                300000
Park Borough                      300000
School Name                       300000
School Number                     299949
School Region                     298485
School Code                       298485
School Phone Number               300000
School Address                    300000
School City                       300000
School State                      300000
School Zip                        300000
School Not Found                  108868
School or Citywide Complaint         325
Vehicle Type                         436
Taxi Company Borough                 416
Taxi Pick Up Location               3733
Bridge Highway Name                 2507
Road Ramp                           2495
Bridge Highway Segment              2491
Garage Lot Name                      228
Ferry Direction                      104
Ferry Terminal Name                  208
Latitude                          275201
Longitude                         275201
Location                          275201
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="n-dimensional-containers">
<h2><em>n</em>-Dimensional Containers<a class="headerlink" href="#n-dimensional-containers" title="Permalink to this headline">¶</a></h2>
<p>While technically a DataFrame is a two-dimensional container, in the next lesson we’ll see why it can perform quite efficienty as a pseudo n-dimensional container.</p>
<p>If you wish to have <em>true</em> n-dimensional DataFrame-like data structures, you should use the <code class="docutils literal notranslate"><span class="pre">xarray</span></code> package and its <code class="docutils literal notranslate"><span class="pre">xr.DataArray</span></code> and <code class="docutils literal notranslate"><span class="pre">xr.Dataset</span></code> objects, which we’ll discuss in the next lessons.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./classes/class_6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../class_5/class_5.html" title="previous page">Class 5: The Scientific Stack - Part II: <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a>
    <a class='right-next' id="next-link" href="../../tutorials.html" title="next page">Tutorials</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dr. Hagai Hargil, Zvi Baratz, Gal Ben-Zvi<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>